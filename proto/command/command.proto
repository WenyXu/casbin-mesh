syntax = "proto3";

package command;

option go_package = "/;command";

message StringArray {
  repeated string s = 1;
}

message BytesArray {
  repeated bytes b = 1 ;
}

message Parameter {
  oneof value {
    sint64 i = 1;
    double d = 2;
    bool b = 3;
    bytes y = 4;
    string s = 5;
    BytesArray a = 7;
  }
}

message Request{
  string ns = 1;
  repeated Parameter parameters = 2;
}

message EnforceRequest {
  Request request = 1;
  bool timings = 2;
  enum Level {
    QUERY_REQUEST_LEVEL_NONE = 0;
    QUERY_REQUEST_LEVEL_WEAK = 1;
    QUERY_REQUEST_LEVEL_STRONG = 2;
  }
  Level level = 3;
  int64 freshness = 4;
}

message ModifyRequest {
  Request request = 1;
}

message Command {
  enum Type {
    COMMAND_TYPE_ENFORCE_REQUEST = 0;
    COMMAND_TYPE_MODIFY_REQUEST = 1 ;
    COMMAND_TYPE_METADATA_SET = 2;
    COMMAND_TYPE_METADATA_DELETE = 3;
    COMMAND_TYPE_NOOP = 4;
  }
  Type type = 1;
  bytes sub_command = 2;
  bool compressed = 3;
}

message MetadataSet {
  string raft_id = 1;
  map<string, string> data = 2;
}

message MetadataDelete {
  string raft_id = 1;
}

message Noop {
  string id = 1;
}